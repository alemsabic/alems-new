{"version":3,"file":"save.js","sourceRoot":"","sources":["../../../src/feed/save.ts"],"names":[],"mappings":";;;;;;;;;AAAA,OAAO,EAAE,IAAI,EAAE,MAAM,MAAM,CAAC;AAI5B,OAAO,EAAE,SAAS,EAAE,MAAM,WAAW,CAAC;AAEtC,OAAO,EAAE,IAAI,EAAiB,MAAM,UAAU,CAAC;AAG/C,MAAM,UAAU,IAAI,CAAC,MAAqB,EAAE,KAAa;IACvD,OAAO,SAAe,QAAQ,CAAC,KAA2B;;YACxD,MAAM,IAAI,GAAG,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;YAExC,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC;gBACpB,KAAK,EAAE,IAAI,CAAC,KAAK;gBACjB,SAAS,EAAE,EAAE;gBACb,EAAE,EAAE,IAAI,CAAC,GAAG,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS;gBAC1C,IAAI,EAAE,IAAI,CAAC,GAAG,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS;gBAC5C,OAAO,EAAE,IAAI,CAAC,GAAG,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO;gBAC3E,WAAW,EAAE,EAAE;gBACf,SAAS,EAAE;oBACT,IAAI,EAAE,IAAI,CAAC,GAAG,GAAG,aAAa;oBAC9B,IAAI,EAAE,IAAI,CAAC,GAAG,GAAG,aAAa;oBAC9B,GAAG,EAAE,IAAI,CAAC,GAAG,GAAG,YAAY;iBAC7B;aACF,CAAC,CAAC;YAEH,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;YAE1C,MAAM,OAAO,CAAC,GAAG,CAAC;gBAChB,SAAS,EAAE,CAAC;oBACV,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI;oBAC5B,IAAI,EAAE,WAAW;oBACjB,OAAO,EAAE,IAAI,CAAC,IAAI,EAAE;iBACrB,CAAC;gBACF,SAAS,EAAE,CAAC;oBACV,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI;oBAC5B,IAAI,EAAE,YAAY;oBAClB,OAAO,EAAE,IAAI,CAAC,KAAK,EAAE;iBACtB,CAAC;gBACF,SAAS,EAAE,CAAC;oBACV,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI;oBAC5B,IAAI,EAAE,YAAY;oBAClB,OAAO,EAAE,IAAI,CAAC,KAAK,EAAE;iBACtB,CAAC;aACH,CAAC,CAAC;QACL,CAAC;KAAA,CAAA;AACH,CAAC","sourcesContent":["import { Feed } from 'feed';\nimport { Item } from 'feed/src/typings';\nimport { join } from 'path';\nimport { CodedocConfig, Build } from '@codedoc/core';\nimport { writeFile } from 'rxline/fs';\n\nimport { fill, PartialConfig } from './config';\n\n\nexport function save(config: PartialConfig, items: Item[]) {\n  return async function saveFeed(build: Build<CodedocConfig>) {\n    const conf = fill(config, build.config);\n\n    const feed = new Feed({\n      title: conf.title,\n      copyright: '',\n      id: conf.url + build.config.dest.namespace,\n      link: conf.url + build.config.dest.namespace,\n      favicon: conf.url + build.config.dest.namespace + build.config.page.favicon,\n      description: '',\n      feedLinks: {\n        json: conf.url + '/_feed.json',\n        atom: conf.url + '/_feed.atom',\n        rss: conf.url + '/_feed.rss',\n      }\n    });\n\n    items.forEach(item => feed.addItem(item));\n\n    await Promise.all([\n      writeFile()({\n        root: build.config.dest.html,\n        path: '_feed.rss',\n        content: feed.rss2()\n      }),\n      writeFile()({\n        root: build.config.dest.html,\n        path: '_feed.atom',\n        content: feed.atom1()\n      }),\n      writeFile()({\n        root: build.config.dest.html,\n        path: '_feed.json',\n        content: feed.json1()\n      }),\n    ]);\n  }\n}\n"]}