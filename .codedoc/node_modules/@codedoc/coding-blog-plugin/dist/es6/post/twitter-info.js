import { StaticRenderer } from '@connectv/sdh';
const URLRegex = /^http(s)\:\/\//;
export function addTwitterMeta() {
    const renderer = new StaticRenderer();
    return function (html) {
        const title$ = html.head.querySelector('title');
        const desc$ = html.head.querySelector('meta[name="description"]');
        if (title$ && !html.head.querySelector('meta[name="twitter:title"]')) {
            renderer.render(renderer.create("meta", { name: "twitter:title", content: title$.textContent || '' })).on(html.head);
        }
        if (desc$ && !html.head.querySelector('meta[name="twitter:description"]')) {
            renderer.render(renderer.create("meta", { name: "twitter:description", content: desc$.getAttribute('content') || '' })).on(html.head);
        }
        if (!html.head.querySelector('meta[name="twitter:image"]')) {
            const container$ = html.body.querySelector('#-codedoc-container');
            if (container$) {
                let img$ = undefined;
                container$.querySelectorAll('img[data-hero]').forEach(hero$ => {
                    if (!img$ && URLRegex.test(hero$.getAttribute('src') || '')) {
                        img$ = hero$;
                    }
                });
                if (!img$) {
                    container$.querySelectorAll('img').forEach(hero$ => {
                        if (!img$ && URLRegex.test(hero$.getAttribute('src') || '')) {
                            img$ = hero$;
                        }
                    });
                }
                if (img$) {
                    const src = img$.getAttribute('src') || '';
                    renderer.render(renderer.create("meta", { name: "twitter:image", content: src })).on(html.head);
                }
            }
        }
    };
}
//# sourceMappingURL=twitter-info.js.map