{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../src/components/article-card/index.tsx"],"names":[],"mappings":"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","sourcesContent":["import { RendererLike, rl } from '@connectv/html';\nimport { transport } from '@connectv/sdh/transport';\nimport { ThemedComponentThis } from '@connectv/jss-theme';\nimport { CodedocTheme } from '@codedoc/core/transport';\nimport { BehaviorSubject } from 'rxjs';\n\nimport { ArticleCardStyle } from './style';\n\n\nexport interface ArticleCardOptions {\n  src: string;\n  style: 'row' | 'box'\n}\n\n\nfunction extractTitle(title: string | null) {\n  if (title) {\n    if ((window as any).source?.title) {\n      const prefix = (window as any).source.title.base + (window as any).source.title.connector;\n      if (title.startsWith(prefix)) return title.substr(prefix.length);\n      else return title;\n    }\n  } else return title;\n}\n\n\nexport function ArticleCard(\n  this: ThemedComponentThis<CodedocTheme>,\n  options: ArticleCardOptions,\n  renderer: RendererLike<any, any>,\n) {\n  const classes = this.theme.classes(ArticleCardStyle);\n\n  const src = new BehaviorSubject<string>(options.src);\n  const img = new BehaviorSubject<string>('https://coding.blog/banner.svg');\n  const title = new BehaviorSubject<string>('Some Article');\n  const desc = new BehaviorSubject<string>('Some description for this article');\n\n  this.track({\n    bind() {\n      let url = options.src;\n      if (options.src.startsWith('/')) {\n        url = `${(window as any).source?.namespace || ''}${options.src}`;\n      }\n\n      src.next(url);\n\n      fetch(url)\n      .then(response => response.text())\n      .then(html => {\n        const marker = <div/>;\n        marker.innerHTML = html;\n        let candidate;\n\n        if (candidate = marker.querySelector('meta[property=\"og:title\"], meta[name=\"twitter:title\"]'))\n          title.next(extractTitle(candidate.getAttribute('content')) || title.value);\n        else if (candidate = marker.querySelector('head > title'))\n          title.next(extractTitle(candidate.textContent) || title.value);\n\n        if (candidate = marker.querySelector(\n          'meta[property=\"og:description\"],' +\n          'meta[name=\"twitter:description\"],' +\n          'meta[name=\"description\"]'\n        )) {\n          desc.next(candidate.getAttribute('content') || '');\n        } else if (candidate = marker.querySelector('#-codedoc-container > p')) {\n          desc.next(candidate.textContent || '');\n        }else {\n          desc.next('');\n        }\n\n        if (candidate = marker.querySelector('meta[property=\"og:image\"], meta[name=\"twitter:image\"]'))\n          img.next(candidate.getAttribute('content') || img.value);\n        else if (candidate = marker.querySelector('img[data-hero]')) {\n          img.next(candidate.getAttribute('src') || img.value);\n        }\n      });\n    }\n  });\n\n  return <a {...(options.style==='box'?{'data-article-card-grid':''}:{})}\n            href={src}\n            class={`${classes.card} ${options.style === 'box' ? classes.cardcol: ''}`}>\n    <div style={rl`background-image: url('${img}')`} class={classes.img}/>\n    <div class={classes.text}>\n      <h1>{title}</h1>\n      <p>{desc}</p>\n    </div>\n  </a>\n}\n\n\nexport const ArticleCard$ = /*#__PURE__*/transport(ArticleCard);"]}