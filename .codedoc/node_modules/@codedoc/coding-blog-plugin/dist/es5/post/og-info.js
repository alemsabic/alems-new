"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.addOGMeta = void 0;
var sdh_1 = require("@connectv/sdh");
var URLRegex = /^http(s)\:\/\//;
function addOGMeta() {
    var renderer = new sdh_1.StaticRenderer();
    return function (html) {
        var title$ = html.head.querySelector('title');
        var desc$ = html.head.querySelector('meta[name="description"]');
        if (!html.head.querySelector('meta[property="og:type"]')) {
            renderer.render(renderer.create("meta", { property: "og:type", content: "article" })).on(html.head);
        }
        if (title$ && !html.head.querySelector('meta[property="og:title"]')) {
            renderer.render(renderer.create("meta", { property: "og:title", content: title$.textContent || '' })).on(html.head);
        }
        if (desc$ && !html.head.querySelector('meta[property="og:description"]')) {
            renderer.render(renderer.create("meta", { property: "og:description", content: desc$.getAttribute('content') || '' })).on(html.head);
        }
        if (!html.head.querySelector('meta[property="og:image"]')) {
            var container$ = html.body.querySelector('#-codedoc-container');
            if (container$) {
                var src_1 = undefined;
                container$.querySelectorAll('img[data-hero]').forEach(function (hero$) {
                    if (!src_1) {
                        var potential = hero$.getAttribute('data-src') || hero$.getAttribute('src') || '';
                        if (URLRegex.test(potential))
                            src_1 = potential;
                    }
                });
                if (!src_1) {
                    container$.querySelectorAll('img').forEach(function (hero$) {
                        if (!src_1 && URLRegex.test(hero$.getAttribute('src') || '')) {
                            src_1 = hero$.getAttribute('src') || '';
                        }
                    });
                }
                if (src_1) {
                    renderer.render(renderer.create("meta", { property: "og:image", content: src_1 })).on(html.head);
                }
            }
        }
    };
}
exports.addOGMeta = addOGMeta;
//# sourceMappingURL=og-info.js.map